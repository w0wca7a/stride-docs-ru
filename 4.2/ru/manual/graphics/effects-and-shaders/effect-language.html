<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Effect language | Stride Manual </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Effect language | Stride Manual ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/stride3d/stride-docs/blob/master/en/manual/graphics/effects-and-shaders/effect-language.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="https://www.stride3d.net/">
            <img id="logo" class="svg" src="../../../media/stride-logo-red.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="effect-language">Effect language</h1>

<div class="WARNING">
<h5>Warning</h5>
<p>Приносим свои извинения за неудобства. Для этой страницы нет перевода на русский язык. Она будет отображаться на английском языке.</p>
</div>
<h2 id="create-shaders-in-c">Create shaders in C#</h2>
<p>You can create a shader at runtime with <a class="xref" href="../../../api/Stride.Shaders.ShaderSource.html">ShaderSource</a> objects. Shaders come in three types:</p>
<ul>
<li><a class="xref" href="../../../api/Stride.Shaders.ShaderClassSource.html">ShaderClassSource</a> correspond to a unique shader class</li>
<li><a class="xref" href="../../../api/Stride.Shaders.ShaderMixinSource.html">ShaderMixinSource</a> mix several <a class="xref" href="../../../api/Stride.Shaders.ShaderSource.html">ShaderSource</a>, set preprocessor values, define compositions</li>
<li><a class="xref" href="../../../api/Stride.Shaders.ShaderArraySource.html">ShaderArraySource</a> are used for arrays of compositions</li>
</ul>
<p>This method produces shaders at runtime. However, many platforms don't support HLSL and have no ability to compile shaders at runtime. Additionally, the approach doesn't benefit from the reusability of mixins.</p>
<h2 id="stride-effects-sdfx">Stride Effects (SDFX)</h2>
<p>Many shaders are variations or combinations of pre-existing shaders. For example, some meshes cast shadows, others receive them, and others need skinning. To reuse code, it's a good idea to select which parts to use through conditions (eg &quot;Skinning required&quot;). This is often solved by &quot;uber shaders&quot;: monolithic shaders configured by a set of preprocessor parameters.</p>
<p>Stride offers the same kind of control, keeping extensibility and reusability in mind. The simple code blocks defined by shader classes can be mixed together by a shader mixer. This process can use more complex logic, described in Stride Effect (*.sdfx) files.</p>
<h3 id="general-syntax">General syntax</h3>
<p>An .sdfx file is a small program used to generate shader permutations. It takes a set of parameters (key and value in a collection) and produces a <code>ShaderMixinSource</code> ready to be compiled.</p>
<p>An example .sdfx file:</p>
<pre><code class="lang-cs">using Stride.Effects.Data;

namespace StrideEffects
{
	params MyParameters
	{
		bool EnableSpecular = true;
	};
	
	effect BasicEffect
	{
		using params MaterialParameters;
		using params MyParameters;

		mixin ShaderBase;
		mixin TransformationWAndVP;
		mixin NormalVSStream;
		mixin PositionVSStream;
		mixin BRDFDiffuseBase;
		mixin BRDFSpecularBase;
		mixin LightMultiDirectionalShadingPerPixel&lt;2&gt;;
		mixin TransparentShading;
		mixin DiscardTransparent;

		if (MaterialParameters.AlbedoDiffuse != null)
		{
			mixin compose DiffuseColor = ComputeBRDFDiffuseLambert;
			mixin compose albedoDiffuse = MaterialParameters.AlbedoDiffuse;
		}

		if (MaterialParameters.AlbedoSpecular != null)
		{
			mixin compose SpecularColor = ComputeBRDFColorSpecularBlinnPhong;
			mixin compose albedoSpecular = MaterialParameters.AlbedoSpecular;
		}
	};
}
</code></pre>
<h3 id="add-a-mixin">Add a mixin</h3>
<p>To add a mixin, use <code>mixin &lt;mixin_name&gt;</code>.</p>
<h3 id="use-parameters">Use parameters</h3>
<p>The syntax is similar to C#. The following rules are added:</p>
<ul>
<li><p>When you use parameter keys, add them using <code>params &lt;shader_name&gt;</code>. If you don't, keys are treated as variables.</p>
</li>
<li><p>You don't need to tell the program where to check the values behind the keys. Just use the key.</p>
</li>
</ul>
<pre><code class="lang-cs">using params MaterialParameters;
 
if (MaterialParameters.AlbedoDiffuse != null)
{
	mixin MaterialParameters.AlbedoDiffuse;
}
</code></pre>
<p>The parameters behave like any variable. You can read and write their value, compare their values, and set template parameters. Since some parameters store mixins, they can be used for composition and inheritance, too.</p>
<h3 id="custom-parameters">Custom parameters</h3>
<p>You can create your own set of parameters using a structure definition syntax.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Even if they're defined in the XKFX file, don't forget the <code>using</code> statement when you want to use them.</p>
</div>
<pre><code class="lang-cs">params MyParameters
{
	bool EnableSpecular = true; // true is the default value
}
</code></pre>
<h3 id="compositions">Compositions</h3>
<p>To add a composition, assign the composition variable to your mixin with the syntax below.</p>
<pre><code class="lang-cs">// albedoSpecular is the name of the composition variable in the mixin
mixin compose albedoSpecular = ComputeColorTexture;
 
or
 
mixin compose albedoSpecular = MaterialParameters.AlbedoSpecular;
</code></pre>
<h3 id="partial-effects">Partial effects</h3>
<p>You can also break the code into sub-mixins to reuse elsewhere with the syntax below.</p>
<pre><code class="lang-cs">partial effect MyPartialEffect
{
	mixin ComputeColorMultiply;
	mixin compose color1 = ComputeColorStream;
	mixin compose color2 = ComputeColorFixed;
}
 
// to use it
mixin MyPartialEffect;
mixin compose myComposition = MyPartialEffect;
</code></pre>
<p>You can use the <code>MyPartialEffect</code> mixin like any other mixin in the code.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="shading-language/index.html">Shading language</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/stride3d/stride-docs/blob/master/en/manual/graphics/effects-and-shaders/effect-language.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <div class="d-flex flex-column flex-sm-row justify-content-between pt-1 text-center small"><p>Supported by the <a href="https://dotnetfoundation.org/" target="_blank" rel="noopener">.NET Foundation</a></p><p>Made with <a href="https://dotnet.github.io/docfx">docfx</a></p><p>Stride Docs Website v.2.0.0.1</p><p>&copy; .NET Foundation and Contributors</p></div>
        </div>
      </div>
    </footer>
  </body>
</html>
