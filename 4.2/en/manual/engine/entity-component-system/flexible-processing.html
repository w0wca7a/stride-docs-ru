<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Flexible Processing | Stride Manual </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Flexible Processing | Stride Manual ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/stride3d/stride-docs/blob/master/en/manual/engine/entity-component-system/flexible-processing.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="https://www.stride3d.net/">
            <img id="logo" class="svg" src="../../../media/stride-logo-red.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="flexible-processing">Flexible Processing</h1>

<p>This document expects the reader to be familiar with ECS, please take a look at <a href="usage.html">usage</a> first.</p>
<p>Handling components through <a class="xref" href="../../../api/Stride.Engine.EntityProcessor.html"><code>EntityProcessor</code></a> may be too rigid in some cases, when the components
you're trying to process cannot share the same base implementation for example.</p>
<p><a class="xref" href="../../../api/Stride.Engine.FlexibleProcessing.IComponent-2.html"><code>Stride.Engine.FlexibleProcessing.IComponent&lt;TProcessor, TThis&gt;</code></a>
provides similar features to <a class="xref" href="../../../api/Stride.Engine.EntityProcessor.html"><code>EntityProcessor</code></a> while being more flexible on the component type,
this document covers some of the usage of this particular interface.</p>
<p>The <code>IComponent</code> interface requires to type parameters,</p>
<ul>
<li><code>TProcessor</code> which is your processor's type.</li>
<li>And <code>TThis</code> which is your component's type.</li>
</ul>
<p>While that last type may seem redundant, it is required to ensure your processor and
your implemented type are compatible.</p>
<p>A summarised example satisfying those type constraint would look like so:</p>
<pre><code class="lang-cs">public class MyComponent : StartupScript, IComponent&lt;MyComponent.MyProcessor, MyComponent&gt;
{
    public class MyProcessor : IProcessor
    {
        public List&lt;MyComponent&gt; Components = new();

        public void SystemAdded(IServiceRegistry registryParam) { }
        public void SystemRemoved() { }

        public void OnComponentAdded(MyComponent item) =&gt; Components.Add(item);
        public void OnComponentRemoved(MyComponent item) =&gt; Components.Remove(item);
    }
}
</code></pre>
<p>The main difference compared to <a class="xref" href="../../../api/Stride.Engine.EntityProcessor.html"><code>EntityProcessor</code></a>
is that <a class="xref" href="../../../api/Stride.Engine.FlexibleProcessing.IComponent-2.html"><code>IComponent</code></a> is not limited to concrete types, your processor may operate on interfaces as well;</p>
<pre><code class="lang-cs">// Here, declaring the interface, which will be the type received by the processor
public interface IInteractable : IComponent&lt;IInteractable.InteractableProcessor, IInteractable&gt;
{
    void Interact();
    public class InteractableProcessor : IProcessor
    {
        // Process each IInteractable here
        // Omitted method implementation for brievety
    }
}

// Now any component implementing IInteractable will be processed by the InteractableProcessor
public class Button : StartupScript, IInteractable
{
    public void Interact(){}
}
public class Character : SyncScript, IInteractable
{
    public void Interact(){}
    public override void Update(){}
}
</code></pre>
<h2 id="updating-processors">Updating Processors</h2>
<p><a class="xref" href="../../../api/Stride.Engine.FlexibleProcessing.IComponent-2.html"><code>Processors</code></a> do not receive any updates by default, you have to implement the <a class="xref" href="../../../api/Stride.Engine.FlexibleProcessing.IUpdateProcessor.html"><code>IUpdateProcessor</code></a> or <a class="xref" href="../../../api/Stride.Engine.FlexibleProcessing.IDrawProcessor.html"><code>IDrawProcessor</code></a>
interface to receive them:</p>
<pre><code class="lang-cs">public interface ISpecialTick : IComponent&lt;ISpecialTick.Processor, ISpecialTick&gt;
{
    void Tick();

    public class Processor : IProcessor, IUpdateProcessor
    {
        public List&lt;ISpecialTick&gt; Components = new();

        public void SystemAdded(IServiceRegistry registryParam) { }
        public void SystemRemoved() { }

        public void OnComponentAdded(ISpecialTick item) =&gt; Components.Add(item);
        public void OnComponentRemoved(ISpecialTick item) =&gt; Components.Remove(item);

        // The execution order of this Update, smaller values execute first compared to other IComponent Processors
        public int Order =&gt; 0;

        public void Update(GameTime gameTime)
        {
            foreach (var comp in Components)
                comp.Tick();
        }
    }
}
</code></pre>
<h2 id="performance">Performance</h2>
<p>While it is more flexible, processing components as interfaces instead of concrete class may introduce some overhead.
If the system you're writing is performance critical you should look into strategies to elide or reduce virtual calls in your hot path.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/stride3d/stride-docs/blob/master/en/manual/engine/entity-component-system/flexible-processing.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <div class="d-flex flex-column flex-sm-row justify-content-between pt-1 text-center small"><p>Supported by the <a href="https://dotnetfoundation.org/" target="_blank" rel="noopener">.NET Foundation</a></p><p>Made with <a href="https://dotnet.github.io/docfx">docfx</a></p><p>Stride Docs Website v.2.0.0.4</p><p>&copy; .NET Foundation and Contributors</p></div>
        </div>
      </div>
    </footer>
  </body>
</html>
