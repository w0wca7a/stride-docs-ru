<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Shadows | Stride Manual </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Shadows | Stride Manual ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/stride3d/stride-docs/blob/master/en/manual/graphics/lights-and-shadows/shadows.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="https://www.stride3d.net/">
            <img id="logo" class="svg" src="../../../media/stride-logo-red.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="shadows">Shadows</h1>

<p><span class="badge text-bg-primary">Beginner</span>
<span class="badge text-bg-success">Designer</span>
<span class="badge text-bg-success">Artist</span></p>
<p>Shadows bring significant information and realism to a scene.</p>
<table>
<thead>
<tr>
<th>Shadows <strong>off</strong></th>
<th>Shadows <strong>on</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/SceneNoShadows.png" alt="media/SceneNoShadows.png"></td>
<td><img src="media/SceneWithShadows.png" alt="media/SceneWithShadows.png"></td>
</tr>
</tbody>
</table>
<p>Only <a href="directional-lights.html">directional lights</a>, <a href="point-lights.html">point lights</a>, and <a href="spot-lights.html">spot lights</a> can cast shadows.</p>
<h2 id="shadow-maps">Shadow maps</h2>
<p>Stride uses <strong>shadow mapping</strong> to render shadows. To understand shadow maps, imagine a camera in the center of the sun, so you're looking down from the sun's perspective.</p>
<p><img src="media/light-and-shadow.png" alt="Light and shadow"></p>
<p>Everything the sun sees is in light. Everything hidden from the sun (ie behind <strong>occluders</strong>) is in shadow.</p>
<p>From this perspective, Stride creates a <strong>shadow map</strong> for each light that casts shadows. This tells us how far each visible pixel is from the light. When Stride renders the scene, it checks the position of each pixel in the shadow map to learn if it can be &quot;seen&quot; by the light. If the light can see the pixel, the light is illuminated. If it can't, the pixel is in shadow.</p>
<p>For example, these are shadow maps from the first-person shooter sample included in Stride, generated by a <a href="directional-lights.html">directional light</a>.</p>
<p><img src="media/fps-sample-scene.png" alt="FPS scene"></p>
<p><img src="media/shadow-atlas-2x.png" alt="FPS scene shadow map"></p>
<div class="NOTE">
<h5>Note</h5>
<p>Note that the directional light in the example above creates four shadow maps, one for each cascade. For more information, see the <a href="directional-lights.html">Directional lights</a> page.</p>
</div>
<h3 id="the-shadow-atlas">The shadow atlas</h3>
<p>Shadow maps for each light that casts a shadow are saved in a region of the <strong>shadow atlas</strong> texture. You can choose how much of the shadow atlas each light uses. The larger the shadow map, the better the shadow quality, but the less space you have for shadow maps from other light sources.</p>
<table>
<thead>
<tr>
<th>Higher-quality shadow (uses a large area of the shadow atlas)</th>
<th>Lower-quality shadow (uses a smaller area of the shadow atlas)</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/shadow-high-resolution.png" alt="High-resolution shadow"></td>
<td><img src="media/shadow-low-resolution.png" alt="Low-resolution shadow"></td>
</tr>
<tr>
<td><img src="media/shadow-atlas-2x.png" alt="FPS scene shadow map"></td>
<td><img src="media/shadow-atlas-1x.png" alt="FPS scene shadow map"></td>
</tr>
</tbody>
</table>
<p>Generally, you should give more space to light sources that cast the most visible shadows.</p>
<p>The size of each area in the shadow map depends on several factors:</p>
<ul>
<li>the <code>shadowMapSizeFactor</code> based on the <code>LightShadowMap.Size</code> property (/8, /4, /2, x1, or x2)</li>
<li>the projected size of the light in screenspace (<code>lightSize</code>)
<ul>
<li>for directional lights, the lightSize is equal to the max (screenWidth, screenHeight)</li>
<li>for spot lights, the lightSize is equal to the projection of the projected sphere at the target spot light cone</li>
</ul>
</li>
<li>the <code>ShadowMapBaseSize</code> equals <code>1024</code></li>
</ul>
<p>The final size of the shadow map is calculated like this:</p>
<pre><code class="lang-cs">// Calculate the size factor
var shadowMapSizeFinalFactor = shadowImportanceFactor * shadowMapSizeFactor;
// Multiply the light projected size by the size factor
var shadowMapSize = NextPowerOfTwo(lightSize * shadowSizeFinalFactor);
// Clamp to a maximum size
shadowMapSize = min(shadowMapSize, ShadowMapBaseSize  * shadowSizeFinalFactor);
</code></pre>
<p>If you've enabled shadows on a light in your scene, but it isn't casting shadows, make sure there's enough space in the shadow atlas to create a shadow map for the light. For more information, see <a href="../../troubleshooting/lights-dont-cast-shadows.html">Troubleshooting — Lights don't cast shadows</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="point-lights.html">Point lights</a></li>
<li><a href="directional-lights.html">Directional lights</a></li>
<li><a href="spot-lights.html">Spot lights</a></li>
<li><a href="../../troubleshooting/lights-dont-cast-shadows.html">Troubleshooting — Lights don't cast shadows</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/stride3d/stride-docs/blob/master/en/manual/graphics/lights-and-shadows/shadows.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <div class="d-flex flex-column flex-sm-row justify-content-between pt-1 text-center small"><p>Supported by the <a href="https://dotnetfoundation.org/" target="_blank" rel="noopener">.NET Foundation</a></p><p>Made with <a href="https://dotnet.github.io/docfx">docfx</a></p><p>Stride Docs Website v.2.0.0.1</p><p>&copy; .NET Foundation and Contributors</p></div>
        </div>
      </div>
    </footer>
  </body>
</html>
